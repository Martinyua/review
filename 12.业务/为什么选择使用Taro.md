### 为什么用Taro作为小程序开发框架

小程序原生开发不够工程化

当时的微信小程序的开发存在一些缺点，比如**依赖管理混乱、工程化流程落后、ES Next 支持不完善、命名规范不统一，没有状态管理等**。这些问题在现在看来都已经有了各种官方或非官方的解决办法，但是在当时小程序开发的探索阶段，这些问题都是一些痛点问题。

- **一个小程序页面或组件，需要同时包含 4 个文件**：逻辑、样式、模板以及配置文件json，	在开发一个功能模块时，就需要在 4 个文件之间切换，而当功能模块多的话，就需要在多个文件之间切换，这样显然非常浪费时间。
- **没有自定义文件预处理**，无法直接使用 **Sass、Less 以及较新的 ES.Next 语法；**
- **字符串模板太过孱弱**，小程序的字符串模板仿的是 **`Vue`**，但是没有提供 **`Vue`** 那么多的语法糖，当实现一些比较复杂的处理时，写起来就非常麻烦，虽然提供了 `wxs` 作为补充，但是使用体验还是非常糟糕；
- **缺乏测试套件**，无法编写测试代码来保证项目质量，也就不能进行持续集成，自动化打包。
- 从开发方式上看，小程序开发没有融入目前主流的工程化开发思想，很多业界开发模式与工具没有在小程序开发中得到相应体现，像是从前端工业时代回退到了刀耕火种的年代。
- 小程序的规范有很多不统一的地方，例如内置组件的属性名，有时候是全小写，有时候是 `CamelCase` 格式，有时候又是中划线分割的形式，这样就导致编码的时候得不时查阅文档才能确定写法
- 虽然支持Promise，但官方的API返回结果并不是Promise，依然是Callback回调函数
- **没有状态管理，参考Vuex和Redux**
- 没有双向数据绑定（严格说这不算是一个缺陷，主要是出于性能的考虑)
- 强制将WXSS、WXML和JS代码分离到3个不同的文件中

Taro打造一套完善编译工具，引入了前置编译的机制，可以自动化地对源文件进行一系列的处理，最终输出小程序上的可执行文件，包括代码的编译转换处理，加入文件预处理功能，支持 NPM 包管理等等。

同时，Taro也提供了与 `react-redux` API 几乎一致的包 `@tarojs/redux` 来让开发人员获得更加良好的开发体验，还增加了额外钩子等，实现了开箱即用。（另外，需要提前安装`redux-thunk`，在h5环境下开发需要安装`@tarojs/redux-h5`避免出错）

### 遇到的问题

**e.stopPropagation()无效**

这个问题其实在类似于React的合成事件和原生事件混用，Taro可能也为了性能优化而添加了中间层进行事件处理。这个问题的解决办法可以使用阻止原生事件冒泡e.nativeEvent.stopPropagation()，但这样Taro的监听函数就调用不到了，或者在阻止冒泡的外部再添加一层包裹的`<View>`来专门阻止冒泡。

npm install --save-dev @tarojs/cli@xxx