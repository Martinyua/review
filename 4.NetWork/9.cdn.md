### 实现方法

**实现方法：** 通过在网络各处放置**节点服务器**所构成的在现有的互联网基础之上的一层**智能虚拟网络**，CDN系统能够实时地根据网络流量和各节点的**连接和负载**状况以及到用户的**距离**和**响应时间**等综合信息将用户的请求重新**导向离用户最近的服务节点**上，加快访问速度。

### 基本工作流程

1. 用户向浏览器输入www.web.com这个域名，浏览器第一次发现本地没有DNS缓存，则向网站的DNS服务器请求；

2. 网站的DNS域名解析器设置了CNAME，指向了www.web.51cdn.com,请求指向了CDN网络中的**智能DNS负载均衡系统；**

3. 智能DNS负载均衡系统解析域名，**把对用户响应速度最快的IP节点（CDN服务器）返回给用户；**

4. 用户向该IP节点（CDN服务器）发出请求；

5. 由于是第一次访问，**CDN服务器会向原web站点请求，并缓存内容；**

6. 请求结果发给用户。



1. 当用户点击网站页面上的内容URL，经过本地DNS系统解析，DNS 系统会最终将域名的解析权交给 CNAME 指向的 **CDN 专用 DNS 服务器。**
2. CDN 的 DNS 服务器将 CDN 的**全局负载均衡设备** IP 地址返回用户。
3. 用户向 CDN 的全局负载均衡设备发起内容 URL 访问请求。
4. CDN 全局负载均衡设备根据用户 IP 地址，以及用户请求的内容URL，选择一台用户所属区域的**区域负载均衡设备**，告诉用户向这台设备发起请求。
5. 基于以下这些条件的综合分析之后，区域负载均衡设备会向全局负载均衡设备返回一台缓存服务器的IP地址：
    • 根据用户 IP 地址，判断哪一台服务器距用户最近；
    • 根据用户所请求的 URL 中携带的内容名称，判断哪一台服务器上有用户所需内容；
    • 查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。
6. 全局负载均衡设备把**服务器的 IP 地址**返回给用户。
7. 用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。如果这台缓存服务器上并没有用户想要的内容，而区域均衡设备依然将它分配给了用户，那么这台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉到本地。
    **DNS 服务器根据用户 IP 地址，将域名解析成相应节点的缓存服务器IP地址**，实现用户就近访问  使用 CDN 服务的网站，只需将其域名解析权交给 CDN 的全局负载均衡（GSLB）设备，将需要分发的内容注入 CDN，就可以实现内容加速了。

* 首先配置了DNS解析，DNS解析系统会将解析权交给CDN的DNS服务器
* **CDN的DNS服务器**将CDN的全局负载均衡设备IP地址返回给用户。
* 用户向CDN的**全局负载均衡设备**发起URL访问请求。
* CDN全局负载均衡设备`根据用户IP地址，以及用户请求的URL`，选择一台用户所属区域的**区域负载均衡设备，**并将请求转发到此设备上。
* 基于以下这些条件的综合分析之后，区域负载均衡设备会选择一个最优的**缓存服务器节点**，并从缓存服务器节点处得到缓存服务器的IP地址，最终将得到的IP地址返回给**全局负载均衡设备**：
  * 根据用户IP地址，判断哪一个边缘节点距用户最近；
  * 根据用户所请求的URL中携带的内容名称，判断哪一个边缘节点上有用户所需内容；
  * 查询各个边缘节点当前的负载情况，判断哪一个边缘节点尚有服务能力。
* **全局负载均衡设备把服务器的IP地址返回给用户。**
* 用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。如果这台缓存服务器上并没有用户想要的内容，而区域均衡设备依然将它分配给了用户，那么这台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉到本地。





### 优势

1. **加速访问**：CDN可以使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。
2. **保障你的网站安全**：CDN的**负载均衡和分布式存储技术**，可以加强网站的可靠性，相当无无形中给你的网站添加了一把保护伞，应对绝大部分的互联网攻击事件。

3. 节约成本